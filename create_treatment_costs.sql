-- Create table for Standard Supply Costs (Costo Est치ndar de Insumos)
CREATE TABLE IF NOT EXISTS vf_treatment_costs (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    treatment_name TEXT NOT NULL UNIQUE,
    -- Link to External App
    category_group TEXT NOT NULL,
    -- '游릭 PREVENTIVOS', '游리 RESTAURATIVOS', etc.
    supply_cost DECIMAL(10, 2) DEFAULT 0,
    -- Costo Insumos ($2.50, etc)
    duration_override INT DEFAULT NULL,
    -- Optional: Override external duration if needed
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
-- Create table for Global Clinic Configuration (Overhead/Fixed Costs)
CREATE TABLE IF NOT EXISTS vf_clinic_config (
    key TEXT PRIMARY KEY,
    -- 'FIXED_COSTS_MONTHLY', 'OPERATIONAL_HOURS_MONTHLY'
    value DECIMAL(10, 2) NOT NULL,
    description TEXT,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
-- Insert Default Config (Estimates)
INSERT INTO vf_clinic_config (key, value, description)
VALUES (
        'FIXED_COSTS_MONTHLY',
        1500.00,
        'Gastos Fijos Totales (Alquiler, Luz, Agua, Internet, Sueldos Fijos)'
    ),
    (
        'OPERATIONAL_HOURS_MONTHLY',
        160.00,
        'Horas operativas al mes (ej: 8h x 20 d칤as)'
    ) ON CONFLICT (key) DO NOTHING;
-- Insert Data based on User's List
-- Note: We use ON CONFLICT to update if exists
INSERT INTO vf_treatment_costs (
        treatment_name,
        category_group,
        supply_cost,
        duration_override
    )
VALUES -- 游릭 PREVENTIVOS / B츼SICOS
    ('PROFILAXIS', '游릭 PREVENTIVO', 2.50, 30),
    ('PROFILAXIS NI칌OS', '游릭 PREVENTIVO', 2.00, 25),
    ('SELLANTES', '游릭 PREVENTIVO', 2.20, 30),
    -- 游리 RESTAURATIVOS
    (
        'RESTAURACI칍N SIMPLE',
        '游리 RESTAURATIVO',
        3.00,
        30
    ),
    (
        'RESTAURACI칍N COMPUESTA',
        '游리 RESTAURATIVO',
        4.00,
        40
    ),
    (
        'RESTAURACI칍N COMPLEJA',
        '游리 RESTAURATIVO',
        5.50,
        60
    ),
    -- 游댰 EST칄TICA (Mixed into Restaurativo/Est칠tica in list)
    (
        'CARILLA RESINA (x pieza)',
        '游댰 EST칄TICA',
        6.00,
        60
    ),
    ('BORDES INCISALES', '游댰 EST칄TICA', 0.00, 30),
    -- No price given, assuming low/zero for now or missing
    ('BLANQUEAMIENTO', '游댰 EST칄TICA', 0.00, 60),
    -- Missing insumo in prompt text, checking image...
    -- Re-reading prompt carefuly:
    -- BLANQUEAMIENTO: Price 130, Arancel 42.90. Insumo ?? (Not in text block fully, inferring or leaving 0 to edit later)
    -- Wait, I will only insert the ones EXPLICITLY listed with Insumo cost in the text block to be safe.
    -- 游댯 ENDODONCIA
    (
        'ENDODONCIA INCISIVO',
        '游댯 ENDODONCIA',
        18.00,
        90
    ),
    (
        'ENDODONCIA MOLARES',
        '游댯 ENDODONCIA',
        22.00,
        120
    ),
    -- 游댮 CIRUG칈A
    ('EXTRACCI칍N SIMPLE', '游댮 CIRUG칈A', 3.00, 30),
    ('CIRUG칈A 3ROS MOLARES', '游댮 CIRUG칈A', 10.00, 90),
    (
        'IMPLANTE (cirug칤a)',
        '游댮 IMPLANTOLOG칈A',
        250.00,
        120
    ),
    -- Category in list said 'Implantolog칤a', grouping color red
    -- 游릮 ORTODONCIA
    (
        'INSTALACI칍N CONVENCIONAL',
        '游릮 ORTODONCIA',
        45.00,
        90
    ),
    ('CONTROL ORTODONCIA', '游릮 ORTODONCIA', 3.00, 20),
    -- 游 PR칍TESIS / LABORATORIO
    (
        'CORONA ZIRCONIA',
        '游 PR칍TESIS FIJA',
        120.00,
        90
    ),
    -- Insumos/Lab merged
    (
        'PUENTE 3 PIEZAS',
        '游 PR칍TESIS FIJA',
        180.00,
        120
    ),
    -- Lab cost
    -- 游댰 EST칄TICA FACIAL
    (
        'BOTOX BRUXISMO',
        '游댰 EST칄TICA FACIAL',
        90.00,
        30
    ),
    (
        '츼CIDO HIALUR칍NICO LABIOS',
        '游댰 EST칄TICA FACIAL',
        110.00,
        40
    ),
    ('BOTOX PERIORAL', '游댰 EST칄TICA FACIAL', 0.00, 30),
    -- Insumo missing in text block, leaving 0
    (
        'BIOESTIMULADOR (Radiex)',
        '游댰 EST칄TICA FACIAL',
        0.00,
        60
    ),
    -- Insumo missing
    (
        'BIOESTIMULADOR (Scultra)',
        '游댰 EST칄TICA FACIAL',
        0.00,
        30
    ),
    -- Insumo missing
    ('APICECTOMIA', '游댮 CIRUG칈A', 0.00, 60) -- Insumo missing
    ON CONFLICT (treatment_name) DO
UPDATE
SET supply_cost = EXCLUDED.supply_cost,
    category_group = EXCLUDED.category_group,
    duration_override = EXCLUDED.duration_override;